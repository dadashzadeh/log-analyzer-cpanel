# 📊 راهنمای کامل فایل Excel خروجی

فایل `security_report.xlsx` که توسط برنامه تولید می‌شود، یک گزارش جامع امنیتی است که در **10 برگه (Sheet)** مختلف اطلاعات را دسته‌بندی کرده. در ادامه توضیح کامل هر برگه:

## 🎯 نحوه باز کردن و مطالعه فایل

1. فایل `security_report.xlsx` را با **Microsoft Excel** یا **Google Sheets** باز کنید
2. در پایین صفحه، تب‌های مختلف را مشاهده خواهید کرد
3. برای دیدن هر بخش، روی نام تب کلیک کنید

---

## 📑 برگه‌های فایل Excel

### 1️⃣ **Overview** (نمای کلی)
#### این برگه چه اطلاعاتی دارد؟
- **تعداد کل درخواست‌ها** به سایت شما
- **تعداد IP های منحصر به فرد** که به سایت دسترسی داشتند
- **بازه زمانی** لاگ‌های بررسی شده
- **حجم ترافیک** مصرف شده
- **درصد خطا** در درخواست‌ها

#### چطور تفسیر کنیم؟
- اگر **درصد خطا بالای 10%** باشد = مشکل احتمالی در سایت یا حمله
- **IP های زیاد با درخواست کم** = ترافیک طبیعی
- **IP های کم با درخواست زیاد** = احتمال حمله DDoS

---

### 2️⃣ **Risk Analysis** (تحلیل خطر)
#### این برگه چه اطلاعاتی دارد؟
جدولی از همه IP ها با این ستون‌ها:
- **IP**: آدرس IP
- **Risk Score**: امتیاز خطر (0-100)
- **Risk Level**: سطح خطر با رنگ‌بندی:
  - 🔴 **CRITICAL** (قرمز): خطر بحرانی - باید فوراً بلاک شود
  - 🟠 **HIGH** (نارنجی): خطر بالا - نیاز به بررسی فوری
  - 🟡 **MEDIUM** (زرد): خطر متوسط - زیر نظر بگیرید
  - 🟢 **LOW** (سبز روشن): خطر کم - احتیاط معمولی
  - ✅ **SAFE** (سبز): ایمن
- **Request Count**: تعداد درخواست‌ها
- **Reasons**: دلایل مشکوک بودن

#### چطور تفسیر کنیم؟
- IP هایی با **Risk Score بالای 70** را حتماً بلاک کنید
- ستون **Reasons** را بخوانید تا بفهمید چرا IP مشکوک است
- IP های **CRITICAL** نیاز به اقدام فوری دارند

---

### 3️⃣ **Critical IPs** (آی‌پی‌های بحرانی)
#### این برگه چه اطلاعاتی دارد؟
فقط **خطرناک‌ترین IP ها** که باید **فوراً بلاک شوند**:
- آدرس IP
- تعداد کل درخواست‌ها
- اولین و آخرین زمان فعالیت
- امتیاز ریسک
- دلیل اصلی خطر

#### چطور تفسیر کنیم؟
**همه IP های این لیست را بدون استثنا در فایروال بلاک کنید!**

---

### 4️⃣ **Attack Patterns** (الگوهای حمله)
#### این برگه چه اطلاعاتی دارد؟
انواع حملات شناسایی شده:
- **Attack Type**: نوع حمله (مثل SQL Injection)
- **IP**: آدرس IP مهاجم
- **Count**: تعداد دفعات حمله
- **Severity**: شدت حمله (CRITICAL/HIGH/MEDIUM/LOW)
- **Sample Request**: نمونه‌ای از درخواست مخرب

#### چطور تفسیر کنیم؟
- حملات **SQL Injection** = تلاش برای هک دیتابیس
- حملات **XSS** = تلاش برای تزریق کد مخرب
- حملات **Command Injection** = تلاش برای اجرای دستورات روی سرور
- هر حمله **CRITICAL** نیاز به اقدام فوری دارد

---

### 5️⃣ **Bot Analysis** (تحلیل ربات‌ها)
#### این برگه چه اطلاعاتی دارد؟
لیست همه ربات‌هایی که سایت را بازدید کرده‌اند:
- **Type**: نوع ربات
  - **Legitimate**: ربات معتبر ✅
  - **Potentially Legitimate**: احتمالاً معتبر 🟡
  - **FAKE**: ربات جعلی ❌
  - **Unknown**: ناشناخته ⚪
- **Company**: نام شرکت (Google, Bing, OpenAI...)
- **IP**: آدرس IP ربات
- **Verification**: وضعیت تأیید هویت
- **Requests**: تعداد درخواست‌ها

#### چطور تفسیر کنیم؟
- ربات‌های **FAKE** را حتماً بلاک کنید
- ربات‌های **Legitimate** را بلاک نکنید (مضر برای SEO)
- اگر **OpenAI** یا **Perplexity** را نمی‌خواهید، می‌توانید بلاک کنید

---

### 6️⃣ **Bot Statistics** (آمار ربات‌ها)
#### این برگه چه اطلاعاتی دارد؟
خلاصه آماری از فعالیت هر ربات:
- نام ربات
- نوع (معتبر/جعلی)
- تعداد کل درخواست‌ها
- تعداد IP های مختلف
- اولین و آخرین بازدید

#### چطور تفسیر کنیم؟
- اگر یک ربات **درخواست‌های زیاد** در **زمان کوتاه** دارد = مشکوک
- ربات معتبر معمولاً از **IP های محدود** استفاده می‌کند

---

### 7️⃣ **Temporal Analysis** (تحلیل زمانی)
#### این برگه چه اطلاعاتی دارد؟
توزیع درخواست‌ها در **24 ساعت شبانه‌روز**:
- ساعت (00:00 تا 23:00)
- تعداد درخواست در آن ساعت

#### چطور تفسیر کنیم؟
- **حجم زیاد در ساعات شب** (2-6 صبح) = مشکوک
- **توزیع یکنواخت** در 24 ساعت = احتمال حمله bot
- **پیک در ساعات اداری** = ترافیک طبیعی

---

### 8️⃣ **Top Requests** (پربازدیدترین صفحات)
#### این برگه چه اطلاعاتی دارد؟
100 صفحه‌ای که بیشترین بازدید را داشته‌اند:
- آدرس صفحه (URL)
- تعداد بازدید
- درصد از کل ترافیک

#### چطور تفسیر کنیم؟
- اگر صفحات **wp-admin** یا **admin** در لیست باشند = تلاش برای هک
- صفحات با پسوند **.php?** معمولاً هدف حمله هستند
- بازدید زیاد از **robots.txt** = فعالیت ربات‌ها

---

### 9️⃣ **Bot Error Analysis** (تحلیل خطاهای ربات)
#### این برگه چه اطلاعاتی دارد؟
خطاهایی که ربات‌ها دریافت کرده‌اند:
- IP ربات
- کد خطا (404, 403, 500...)
- نوع خطا
- صفحه درخواستی
- نوع ربات

#### چطور تفسیر کنیم؟
- **خطای 404 زیاد** = ربات دنبال صفحات قدیمی است
- **خطای 403 زیاد** = ربات تلاش برای دسترسی غیرمجاز دارد
- **خطای 500** = مشکل در سرور هنگام پردازش درخواست ربات

---

### 🔟 **User Agents** (مرورگرها و دستگاه‌ها)
#### این برگه چه اطلاعاتی دارد؟
لیست مرورگرها و دستگاه‌هایی که از سایت بازدید کرده‌اند:
- User Agent (اطلاعات مرورگر)
- تعداد درخواست
- نوع (Desktop/Mobile/Bot/Hacking Tool)
- درصد از کل

#### چطور تفسیر کنیم؟
- **Hacking Tool** = ابزار هک، حتماً بلاک کنید
- **Empty/Invalid** = بدون شناسه، مشکوک است
- درصد بالای **Bot/Crawler** = سایت شما هدف ربات‌هاست

---

## 🎨 رنگ‌بندی در Excel

فایل Excel از **رنگ‌بندی هوشمند** استفاده می‌کند:

| رنگ | معنی | اقدام لازم |
|------|------|------------|
| 🔴 **قرمز** | خطر بحرانی | بلاک فوری |
| 🟠 **نارنجی** | خطر بالا | بررسی سریع |
| 🟡 **زرد** | هشدار | زیر نظر بگیرید |
| 🟢 **سبز** | ایمن | اقدامی لازم نیست |

---

## 📝 نکات مهم برای کاربران

### ✅ کارهایی که باید انجام دهید:
1. **ابتدا برگه Critical IPs را چک کنید** - این‌ها باید فوراً بلاک شوند
2. **برگه Risk Analysis را مرتب کنید** بر اساس Risk Score (از زیاد به کم)
3. **IP های با امتیاز بالای 70** را در فایروال بلاک کنید
4. **ربات‌های FAKE** در برگه Bot Analysis را بلاک کنید
5. **الگوهای حمله** در Attack Patterns را به تیم فنی اطلاع دهید

### ❌ کارهایی که نباید انجام دهید:
1. **ربات‌های Legitimate را بلاک نکنید** (به SEO آسیب می‌زند)
2. **IP های با Risk Score زیر 30** را بلاک نکنید (احتمالاً کاربر عادی)
3. **بدون بررسی Reasons، IP ای را بلاک نکنید**

---

## 💡 توصیه‌های کاربردی

### برای صاحبان سایت:
- هر **هفته** یکبار این گزارش را تولید و بررسی کنید
- IP های Critical را **بلافاصله** بلاک کنید
- اگر حملات زیاد است، از **Cloudflare** یا **CDN** استفاده کنید

### برای مدیران فنی:
- داده‌های Attack Patterns را برای **تقویت امنیت** کد استفاده کنید
- الگوهای Temporal Analysis را برای **تنظیم Rate Limiting** به کار ببرید
- لیست User Agents مشکوک را در **WAF** تنظیم کنید

---

## 🔍 سوالات متداول

**س: کدام برگه مهم‌تر است؟**
ج: به ترتیب: Critical IPs > Risk Analysis > Attack Patterns

**س: چند IP را می‌توانم بلاک کنم؟**
ج: همه IP های با Risk Score بالای 70 و همه Critical IPs

**س: آیا بلاک کردن ربات‌ها به SEO آسیب می‌زند؟**
ج: فقط ربات‌های FAKE را بلاک کنید، نه Legitimate ها

**س: چقدر زمان برای بررسی فایل نیاز است؟**
ج: حدود 10-15 دقیقه برای بررسی کامل

---

## 📞 نیاز به کمک؟

اگر در تفسیر داده‌ها مشکل دارید:
1. ابتدا به ستون **Reasons** در Risk Analysis نگاه کنید
2. رنگ‌بندی سلول‌ها را دنبال کنید
3. فقط روی IP های قرمز و نارنجی تمرکز کنید